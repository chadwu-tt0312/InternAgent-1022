# InternAgent 專案說明文件

## 1. 專案用途

**InternAgent** 是一個**自動化科學研究系統**，旨在協助研究人員完成從「研究想法」到「實驗驗證」的完整研究循環。

### 核心概念（以大學生能理解的方式說明）

想像你是一位研究生，想要發表一篇論文。通常你需要：

1. **想出新點子**：提出一個創新的研究方法
2. **查資料**：閱讀相關論文，了解現有方法
3. **設計方法**：把想法轉換成具體的技術方案
4. **寫程式碼**：實作你的方法
5. **做實驗**：執行程式，看結果好不好
6. **修正錯誤**：如果程式出錯，要除錯
7. **比較結果**：看看你的方法是否比現有方法更好

**InternAgent 就是一個 AI 助手，可以自動幫你完成上述所有步驟！**

### 系統三大核心能力

#### (1) 自我演化的想法生成（Self-evolving Idea Generation）
- **功能**：自動產生多個研究想法，並根據專家反饋持續改進
- **特點**：會自動搜尋相關論文、分析現有程式碼，產生有根據的創新想法
- **類比**：就像有一個 AI 研究夥伴，會幫你想出多個研究方向，並根據你的意見調整

#### (2) 想法到方法的建構（Idea-to-Methodology）
- **功能**：將抽象的研究想法轉換成具體、可驗證的技術方法
- **特點**：會參考基準程式碼、相關文獻，自動生成完整的方法論框架
- **類比**：就像把「我想做一個更好的影像分類模型」這個想法，轉換成「使用注意力機制結合卷積神經網路，具體公式是...」的詳細方案

#### (3) 演化式實驗規劃與執行（Evolutionary Experimental Planning and Execution）
- **功能**：自動規劃實驗流程、實作程式碼、除錯、執行實驗
- **特點**：如果程式出錯，會自動分析錯誤並修正；如果實驗結果不好，會調整參數重新實驗
- **類比**：就像有一個 AI 程式設計師，會幫你寫程式、測試、修正錯誤，直到實驗成功為止

### 支援的研究領域

系統支援 **12 種不同類型的科學研究任務**，涵蓋：

**AI 領域**：
- 影像分類（2D/3D）
- 語義分割（Semantic Segmentation）
- 點雲分類（Point Cloud Classification）
- 自駕車感知（Autonomous Driving）
- 大型視覺語言模型微調（VLM & LLM Fine-tuning）
- 情感分析（Sentiment Analysis）

**科學領域**：
- 化學反應產率預測（Suzuki Yield Prediction）
- 分子動力學模擬（Molecular Dynamics）
- 增強子活性預測（Enhancer Activity Prediction）
- 轉錄預測（Transcription Prediction）
- 電力流估計（Power Flow Estimation）
- 時間序列預測（Time Series Forecasting）

---

## 2. 專案的 Input/Output

### 輸入（Input）

#### 主要輸入：任務描述檔案（`prompt.json`）

每個研究任務都有一個 `prompt.json` 檔案，包含：

```json
{
    "task_description": "你的任務是提出一個語義分割方法...",
    "domain": "Semantic Segmentation",
    "background": "相關的背景知識和觀察...",
    "constraints": ["約束條件1", "約束條件2"]
}
```

**用途**：
- `task_description`：告訴系統你想要解決什麼問題
- `domain`：指定研究領域（如「語義分割」、「化學反應預測」等）
- `background`：提供相關的背景知識、現有方法的觀察、初步假設等
- `constraints`：列出限制條件（如「模型輸入是 RGB 影像」）

#### 次要輸入：基準程式碼（Baseline Code）

- **位置**：`tasks/{任務名稱}/experiment.py` 或 `tasks/{任務名稱}/run_0/`
- **用途**：提供現有的實作作為基準，系統會在此基礎上改進

#### 配置檔案（Configuration）

- **位置**：`config/default_config.yaml`
- **內容**：LLM 設定、Agent 參數、工作流程設定等

### 輸出（Output）

#### (1) 研究想法（Ideas）

**檔案位置**：`results/{任務名稱}/ideas.json`

**內容格式**：
```json
[
    {
        "name": "idea_1",
        "title": "基於注意力機制的語義分割方法",
        "description": "詳細描述...",
        "method": "具體的技術方法說明，包含公式和演算法..."
    }
]
```

**用途**：記錄系統生成的所有研究想法，包含：
- 想法名稱和標題
- 詳細描述
- 具體的技術方法（包含數學公式、演算法等）

#### (2) 想法演化視覺化（Idea Evolution Visualization）

**檔案位置**：`results/{任務名稱}/{任務名稱}_ideas_{session_id}.pdf`

**內容**：以樹狀圖或流程圖展示想法的演化過程，顯示：
- 初始想法如何產生
- 如何根據反饋改進
- 想法的評分和排名

**用途**：幫助研究人員理解系統的思考過程

#### (3) 實驗結果（Experiment Results）

**檔案位置**：`results/{任務名稱}/{時間戳}_{想法名稱}/`

**內容包含**：

1. **修改後的程式碼**：
   - `experiment.py`：實作新方法的程式碼
   - 相關的模型檔案、工具檔案等

2. **實驗執行記錄**：
   - `log.txt`：實驗執行的日誌
   - `{想法名稱}_aider.txt`：與 AI 程式設計師的對話記錄

3. **實驗結果**：
   - `run_1/final_info.json`：第一次實驗的結果
   - `run_2/final_info.json`：第二次實驗的結果（如果有多輪實驗）
   - 訓練日誌、模型檢查點等

4. **錯誤追蹤**（如果實驗失敗）：
   - `run_X/traceback.log`：錯誤堆疊追蹤
   - 詳細的錯誤訊息

**結果格式範例**：
```json
{
    "AutoSeg": {
        "means": {
            "mIoU": 81.0
        }
    }
}
```

#### (4) 執行摘要（Discovery Summary）

**檔案位置**：`results/{任務名稱}/discovery_summary.json`

**內容**：
```json
{
    "timestamp": "2025-01-XX...",
    "task": "AutoSeg",
    "total_ideas": 3,
    "successful": 2,
    "failed": 1,
    "results": [
        {
            "idea_name": "idea_1",
            "success": true
        }
    ]
}
```

**用途**：提供整個研究流程的總覽，包含：
- 測試了多少個想法
- 成功/失敗的數量
- 每個想法的執行狀態

### 最終產出及其作用

#### 1. **改進的研究方法**
- **形式**：詳細的技術方法描述，包含數學公式、演算法、實作細節
- **作用**：可以直接用於撰寫論文的方法論部分

#### 2. **實作程式碼**
- **形式**：完整的 Python 程式碼，可以直接執行
- **作用**：可以直接用於實驗，或作為進一步開發的基礎

#### 3. **實驗結果與效能指標**
- **形式**：JSON 格式的量化結果（如準確率、mIoU、R² 等）
- **作用**：
  - 驗證方法的有效性
  - 與基準方法比較
  - 用於論文的實驗結果部分

#### 4. **研究流程記錄**
- **形式**：想法演化視覺化、對話記錄、執行日誌
- **作用**：
  - 理解系統的思考過程
  - 追蹤實驗的執行歷史
  - 用於論文的方法論說明

---

## 3. 專案使用的 LLM

### 支援的 LLM 提供者

系統支援多種 LLM 提供者，可以透過配置檔案切換：

1. **OpenAI**（`openai`）
   - 模型：`gpt-4o`, `gpt-4o-mini`, `gpt-4o-2024-11-20` 等
   - 用途：通用任務

2. **Azure OpenAI**（`azure`）
   - 模型：`gpt-4o`, `gpt-4o-mini` 等
   - 用途：預設提供者，用於大部分任務

3. **Intern-S1**（`interns1`）
   - 模型：`intern-s1`
   - 用途：科學研究任務的專用模型

4. **DeepSeek-R1**（`dsr1`）
   - 模型：`DeepSeek-R1`
   - 用途：需要深度推理的任務

### LLM 在各個 Agent 中的使用

系統使用**多智能體架構**（Multi-Agent System），每個 Agent 負責不同的任務，並使用 LLM 來完成：

#### (1) **Generation Agent（想法生成 Agent）**
- **使用的 LLM**：預設使用 `default_provider`（通常是 Azure）
- **產生什麼結果**：
  - 多個研究假設（Hypotheses）
  - 每個假設的合理性說明（Rationale）
  - 對基準程式碼的理解摘要（Baseline Summary）

#### (2) **Survey Agent（文獻調查 Agent）**
- **使用的 LLM**：預設使用 `default_provider`
- **產生什麼結果**：
  - 從 arXiv、PubMed 等資料庫搜尋相關論文
  - 分析論文的相關性和重要性
  - 提取關鍵資訊供其他 Agent 使用

#### (3) **CodeView Agent（程式碼分析 Agent）**
- **使用的 LLM**：預設使用 `default_provider`
- **產生什麼結果**：
  - 分析基準程式碼的結構和功能
  - 理解程式碼的設計模式
  - 提供程式碼層級和檔案層級的分析

#### (4) **Reflection Agent（反思 Agent）**
- **使用的 LLM**：預設使用 `default_provider`
- **產生什麼結果**：
  - 對生成的想法進行批判性分析
  - 識別想法的優點和缺點
  - 提供改進建議

#### (5) **Evolution Agent（演化 Agent）**
- **使用的 LLM**：預設使用 `default_provider`
- **產生什麼結果**：
  - 根據反饋改進現有想法
  - 產生想法的變體
  - 探索不同的研究方向

#### (6) **Method Development Agent（方法開發 Agent）**
- **使用的 LLM**：通常使用更強大的模型（如 `gpt-4o-2024-11-20`）
- **產生什麼結果**：
  - 將抽象想法轉換成具體的方法論
  - 設計演算法和數學公式
  - 規劃實作步驟

#### (7) **Refinement Agent（精煉 Agent）**
- **使用的 LLM**：通常使用更強大的模型（如 `gpt-4o-2024-11-20`）
- **產生什麼結果**：
  - 根據批判意見改進方法
  - 優化技術細節
  - 產生最終的改進方法描述

#### (8) **Ranking Agent（排名 Agent）**
- **使用的 LLM**：預設使用 `default_provider`
- **產生什麼結果**：
  - 對多個想法進行評分
  - 排名想法的優先順序
  - 選出最有潛力的想法

#### (9) **Coding Agent（程式設計 Agent）**
- **使用的 LLM**：透過 Aider 或 OpenHands 後端，使用配置的實驗模型
- **產生什麼結果**：
  - 根據方法描述修改程式碼
  - 實作新的功能
  - 修正程式錯誤

### LLM 配置範例

在 `config/default_config.yaml` 中：

```yaml
models:
  default_provider: "azure"  # 預設使用 Azure
  
  azure:
    model_name: "gpt-4o-mini"
    temperature: 0.2

agents:
  generation:
    model_provider: "default"  # 使用 default_provider
    generation_count: 5
    
  method_development:
    model_provider: "azure"
    model_name: "gpt-4o-2024-11-20"  # 使用更強大的模型
```

---

## 4. 專案在公司內部的應用方向

### (1) **研發加速器（R&D Accelerator）**
- **應用場景**：研發團隊需要快速探索新的技術方向
- **價值**：
  - 自動產生多個研究方向，節省人力時間
  - 快速驗證想法的可行性
  - 減少重複性的實驗工作

### (2) **論文發表支援（Publication Support）**
- **應用場景**：研究團隊需要發表高品質論文
- **價值**：
  - 自動生成創新方法，提高論文的創新性
  - 自動實作和實驗，確保方法可重現
  - 提供完整的研究流程記錄，便於撰寫論文

### (3) **技術方案探索（Solution Exploration）**
- **應用場景**：產品團隊需要解決特定的技術問題
- **價值**：
  - 自動探索多種解決方案
  - 快速比較不同方法的效能
  - 找出最優的技術方案

### (4) **基準測試與競賽（Benchmarking & Competition）**
- **應用場景**：參與學術競賽或基準測試
- **價值**：
  - 自動產生多個改進方法
  - 系統性地測試不同想法
  - 提高在競賽中的競爭力

### (5) **知識傳承與教育（Knowledge Transfer & Education）**
- **應用場景**：新進研究人員的培訓
- **價值**：
  - 展示完整的研究流程
  - 提供想法演化的視覺化
  - 作為學習科學研究方法的工具

### (6) **自動化實驗平台（Automated Experimentation Platform）**
- **應用場景**：需要大量實驗的專案
- **價值**：
  - 自動規劃和執行實驗
  - 自動除錯和優化
  - 減少人工介入，提高效率

### (7) **跨領域研究（Cross-domain Research）**
- **應用場景**：將 AI 技術應用到其他領域（如化學、生物學）
- **價值**：
  - 自動理解不同領域的需求
  - 自動搜尋相關文獻
  - 自動設計適合該領域的方法

---

## 5. 需要補充說明的部分

### (1) **系統架構說明**

**建議補充**：
- 多智能體系統（MAS）的整體架構圖
- 各個 Agent 之間的互動流程
- 資料流和狀態管理機制

**目前狀態**：
- 程式碼中有實作，但缺少視覺化的架構說明
- README 中有框架圖，但缺少詳細的技術說明

### (2) **環境設定與依賴**

**建議補充**：
- 詳細的環境安裝步驟（包含 Python 版本、CUDA 版本等）
- 各個任務的特定依賴說明
- 常見的安裝問題和解決方案

**目前狀態**：
- README 中有基本安裝說明，但可能不夠詳細
- 不同任務可能需要不同的環境設定

### (3) **API 金鑰與權限設定**

**建議補充**：
- 如何取得各種 LLM 的 API 金鑰
- 如何設定環境變數
- API 使用成本估算
- 速率限制和配額管理

**目前狀態**：
- 需要設定 `.env` 檔案，但缺少詳細說明
- 不同提供者的 API 設定方式可能不同

### (4) **任務配置指南**

**建議補充**：
- 如何建立新的研究任務
- `prompt.json` 的撰寫指南
- 基準程式碼的準備要求
- 實驗結果格式的規範

**目前狀態**：
- 有範例任務，但缺少建立新任務的詳細指南

### (5) **效能調優與最佳實踐**

**建議補充**：
- 如何調整 Agent 參數以獲得更好的結果
- 如何選擇合適的 LLM
- 如何處理實驗失敗的情況
- 如何解讀實驗結果

**目前狀態**：
- 有配置檔案，但缺少參數調優的指南

### (6) **錯誤處理與除錯**

**建議補充**：
- 常見錯誤類型及解決方法
- 如何閱讀和解析錯誤日誌
- 如何手動介入和修正
- 系統監控和健康檢查

**目前狀態**：
- 有錯誤日誌功能，但缺少除錯指南

### (7) **擴展性與自訂**

**建議補充**：
- 如何新增自訂的 Agent
- 如何整合新的 LLM 提供者
- 如何新增新的工具（如新的文獻搜尋來源）
- 如何自訂工作流程

**目前狀態**：
- 系統設計支援擴展，但缺少擴展指南

### (8) **安全性與隱私**

**建議補充**：
- API 金鑰的安全管理
- 資料隱私保護措施
- 程式碼和實驗結果的存取控制
- 合規性考量

**目前狀態**：
- 需要補充安全性說明

### (9) **成本管理**

**建議補充**：
- LLM API 呼叫的成本估算
- 如何減少 API 呼叫次數
- 如何選擇成本效益最佳的 LLM
- 預算控制和監控

**目前狀態**：
- 需要補充成本管理指南

### (10) **實際案例與教學**

**建議補充**：
- 完整的端到端使用案例
- 從任務設定到結果分析的完整流程
- 常見問題解答（FAQ）
- 影片教學或互動式教學

**目前狀態**：
- 有範例任務，但缺少詳細的使用案例說明

---

## 總結

**InternAgent** 是一個強大的自動化科學研究系統，可以協助研究人員完成從想法生成到實驗驗證的完整流程。系統使用多個 AI Agent 協同工作，每個 Agent 負責不同的任務，並使用 LLM 來完成複雜的推理和生成工作。

**主要優勢**：
- ✅ 自動化完整的研究流程
- ✅ 支援多種研究領域
- ✅ 可擴展的架構設計
- ✅ 詳細的執行記錄和視覺化

**適用對象**：
- 研究人員和工程師
- 需要快速探索技術方向的團隊
- 參與學術競賽的團隊
- 需要自動化實驗的專案

**未來改進方向**：
- 增強文件說明和教學資源
- 提供更多使用案例和最佳實踐
- 改善錯誤處理和使用者體驗
- 加強成本管理和效能優化

